<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="轩邈">
    <meta name="copyright" content="轩邈">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <!-- 网站SEO -->
    <title>Title</title>
    <meta name="keywords" content="轩邈 xuanmiao xuanmiao.com">
    <meta name="description" content="轩邈 | 猎奇蜗牛">
    <!-- 标题栏logo图标 -->
    <link rel="icon" href="" type="image/x-icon">
    <!-- 收藏夹logo图标 -->
    <link rel="shortcut icon" href="" type="image/x-icon">
    <style>
        body{
            margin: 0;
        }
        #calendar{
            position: relative;
            margin: 20px auto;
            box-sizing: border-box;
            border: 1px solid transparent;
            padding: 20px;
            width: 360px;
            height: 520px;
            font: 15px/30px 微软雅黑;
            color: #CEDFE6;
            background: #075C7D;
            box-shadow: 0 0 20px 0 rgba(7,91,125,0.5);
        }
        .time{
            margin: 10px auto auto -6px;
            font:700 40px/40px microsoft yahei;
            color: #eee;
        }
        .date{
            color: #59D1FF;
            font: 400 15px/10px microsoft yahei;
        }
        .top-box h3{
            display: inline-block;
            font: 400 18px/24px microsoft yahei;
            width: 220px;
        }
        .top-box  div{
            display: inline-block;
            font: 400 22px/24px microsoft yahei;
            width: 44px;
            text-align: right;
            cursor: pointer;
           -moz-user-select: none;
           -webkit-user-select: none;
            -ms-user-select: none;
        }
        .top-box div:hover{
            color: #1EC0FF;
        }
        .day-number{
            margin:0 -17px ;
        }
        .day-number span{
            display: inline-block;
            text-align: center;
            line-height: 41px;
            color: #fff;
        }
        .week-day-number{
            margin-left: 4px;
        }
        .week-day-number span{
            width: 45px;
            font-size: 12px;
        }
        .date-day-number span{
            box-sizing: border-box;
            border: 2px solid transparent;
            width: 50px;
            font: 20px/41px microsoft yehei;
        }
        .date-day-number span:hover{
            border: 2px solid #85ACBC;
        }
        .date-day-number{
            height: 255px;
            overflow: hidden;
        }

        .date-day-number .last-month{
            margin-top: -270px;
        }

        .set-btn{
            width: 120px;
            line-height: 30px;
            color: #59D1FF;
            text-decoration: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            cursor:  pointer;
        }
        .set-btn:hover{
            /*color: #30A9DE;80D4F6 00DFFC 1EC0FF 45D9FD*/
            color: #1EC0FF;
        }
        .popup-window{
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            width: 600px;
            height: 300px;
            background: #007EAE;
            transform: translate(-50%,-50%);
            color: #fff;
        }
        .popup-window h2{
            margin: 20px 0 auto 30px;
            font: 400 25px/30px microsoft yahei;
        }
        .popup-window h4{
            margin: 10px 0 auto 30px;
            font: 400 16px/30px microsoft yehei;
        }
        .popup-window select{
            margin: auto 0 20px 30px;
            padding: 2px 6px;
            outline: 2px solid #66B2CE;
            border: none;
            width: 100px;
            font: 400 16px/30px microsoft yehei;
            text-align: center;
            background: #004C68;
            color: #fff;
        }
        .popup-window select:hover{
            background: #003246;
        }
        .popup-window .operation-btns {
            float: right;
            margin: 50px 10px auto auto;
            width: 240px;
        }
        .popup-window .operation-btns div{
            display: inline-block;
            margin: 10px;
            padding: 0 30px;
            border: 2px solid #fff;
            cursor: pointer;
        }
        .popup-window .operation-btns div:hover{
            opacity: 0.9;
        }
        .popup-window .operation-btns div.default{
            background: #32B5E7;
        }
    </style>
</head>
<body>
    <div id="calendar">
        <h1 class="time"> 00:00:00</h1>
        <h2 class="date">1970年01月01日, 星期二</h2>
        <div class="top-box">
            <h3 class="year-and-month">2017年8月</h3>
            <div class="prev" title="上一月">▲</div>
            <div class="next" title="下一月">▼</div>
        </div>
        <div class="day-number">
            <div class="week-day-number">
                <span>日</span>
                <span>一</span>
                <span>二</span>
                <span>三</span>
                <span>四</span>
                <span>五</span>
                <span>六</span>
            </div>
            <div class="date-day-number">
                <div class="last-month"></div>
                <div class="current-month"></div>
                <div class="next-month"></div>
            </div>
        </div>

        <div class = "set-btn" href="">日期和时间设置</div>
        <div class="popup-window">
            <h2>更改日期和时间</h2>
            <h4>日期</h4>
            <select name="year" id="yearSelect" title="yearSelect"></select>
            <select name="month" id="monthSelect" title="month">
                <option value="january">一月</option>
                <option value="february">二月</option>
                <option value="march">三月</option>
                <option value="april">四月</option>
                <option value="may">五月</option>
                <option value="june">六月</option>
                <option value="july">七月</option>
                <option value="august">八月</option>
                <option value="september">九月</option>
                <option value="october">十月</option>
                <option value="november">十一月</option>
                <option value="december">十二月</option>
            </select>
            <select name="date-day" id="dateDaySelect" title="date-day"></select>
            <h4>时间</h4>
            <select name="hour" id="hourSelect" title="hour"></select>
            <select name="minute" id="minuteSelect" title="minute"></select>
            <div class="operation-btns">
                <div class="change default">更改</div>
                <div class="cancel">取消</div>
            </div>
        </div>
    </div>
    <script src="animal_collection.js"></script>
    <script src="jquery-3.1.1.js"></script>
<script>
    //获取元素
    {
        var time = document.querySelector('#calendar .time');
        var dateShow = document.querySelector('#calendar .date');
        var yearAndMonth = document.querySelector('#calendar .year-and-month');
        var prev = document.querySelector('#calendar .prev');
        var next = document.querySelector('#calendar .next');
        var lastMonth = document.querySelector('#calendar .date-day-number .last-month');
        var currentMonth = document.querySelector('#calendar .date-day-number .current-month');
        var nextMonth = document.querySelector('#calendar .date-day-number .next-month');
        var setBtn = document.querySelector('#calendar .set-btn');
        var popupWindow = document.querySelector(".popup-window");
        var yearSelect  = document.querySelector("#yearSelect");
        var monthSelect  = document.querySelector("#monthSelect");
        var dateDaySelect  = document.querySelector("#dateDaySelect");
        var hourSelect  = document.querySelector("#hourSelect");
        var minuteSelect  = document.querySelector("#minuteSelect");
        var changeBtn = document.querySelector(".popup-window .change");
        var cancelBtn = document.querySelector(".popup-window .cancel");
    }
    //声明变量
    {
        var date = new Date();
        var weekDayNumberArray = [
            "日",
            "一",
            "二",
            "三",
            "四",
            "五",
            "六"
        ];
        var InitalMonthNumber = date.getMonth();
        var InitalFullNumber = date.getFullYear();
        var month = [
            "january",
            "february",
            "march",
            "april",
            "may",
            "june",
            "july",
            "august",
            "september",
            "october",
            "november",
            "december"
        ];
        //移动的距离
        var moveDistance = 270;
        //日历默认的位置
        var initialPosition = -270;
        //动画是否在执行
        var isAnimationExecuting = false;
        //动画执行时间
        var duration = 200;
    }
    //初始化
    getTime();
    getDate();
    initialDateDayNumber(); //？span 和 div会出现样式改变  appedchild添加的元素之间没有空白
    var lastMonthItem = document.querySelectorAll('#calendar .date-day-number .last-month span');
    var currentMonthItem = document.querySelectorAll('#calendar .date-day-number .current-month span');
    var nextMonthItem = document.querySelectorAll('#calendar .date-day-number .next-month span');
    getDateDayNumber(currentMonthItem,InitalMonthNumber);
    initialSelect();
    refreshTime();
    refreshDate();
    refreshDateDayNumber();

    prev.onclick = function ()  {
        InitalMonthNumber --;
        monthOutAndYearSwitchJudge();
        if(isAnimationExecuting) return;
        isAnimationExecuting = true;
        moveAnimation(moveDistance);
    };
    next.onclick = function () {
        InitalMonthNumber ++;
        monthOutAndYearSwitchJudge();
        if(isAnimationExecuting) return ;
        isAnimationExecuting = true;
        MTween(lastMonth,moveDistance,duration,'marginTop','linear',function () {
            if(getCss(lastMonth,'marginTop')  === initialPosition*2 || getCss(lastMonth,'marginTop')  === 0){
                lastMonth.style.marginTop = initialPosition + "px";
            }
            isAnimationExecuting = false;
        });
        moveAnimation(-moveDistance);
    };
    //日期和时间设置按钮点击事件
    setBtn.onclick = function () {
        popupWindow.style.display = "block";
    };
    changeBtn.onclick = function () {
        popupWindow.style.display = "none";
    };
    cancelBtn.onclick = function () {
        popupWindow.style.display = "none";
    };
    //刷新函数
    function refreshTime(){
        setInterval(getTime,1000);
    }
    function refreshDate(){
        setInterval(getDate,20 * 60 * 60 * 1000);
    }
    function refreshDateDayNumber(){
        setInterval(getDateDayNumber(currentMonthItem,InitalMonthNumber),20 * 60 * 60 * 1000);
    }

    //更改时间
    function getTime() {
        var date = new Date();
        var hours = date.getHours();
        var minutes = date.getMinutes();
        var seconds = date.getSeconds();
        if(hours<10) hours = '0' + hours;
        if(minutes<10) minutes = '0' + minutes;
        if(seconds<10) seconds = '0' + seconds;
        time.innerHTML = hours + ":" + minutes + ":" + seconds;
    }
    //更改日期
    function getDate(){
        var date1 = new Date();
        var year = date1.getFullYear();
        var mouth = date1.getMonth() + 1;
        var dateDayNumber = date1.getDate();
        var weekDayNumber = date1.getDay();
        if(year<10) year = '0' + year;
        if(mouth<10) mouth = '0' + mouth;
        if(dateDayNumber<10) dateDayNumber = '0' + dateDayNumber;
        dateShow.innerHTML = year + "年" +  mouth + "月" + dateDayNumber + "日, 星期" +weekDayNumberArray[weekDayNumber];
        yearAndMonth.innerHTML =  year + "年" +  (date1.getMonth() + 1) + "月";
    }
    //获取本月天数
    function getMonthDayCount(month,year){
        var date = new Date();
        year && date.setFullYear(year);
        date.setMonth(month);
        date.setMonth(date.getMonth());
        date.setDate(0);
        return date.getDate();
    }
    //更改日期显示
    function getDateDayNumber(obj,InitalMonthNumber){
        var monthDayCount = getMonthDayCount(InitalMonthNumber + 1);
        var lastMonthDayCount = getMonthDayCount(InitalMonthNumber);
        var date = new Date();
        var currentDate = date.getDate();
        var currentMonth = date.getMonth();
        date.setMonth(InitalMonthNumber);
        date.setFullYear(InitalFullNumber);
        date.setDate(1);
        var weekDayNumber = date.getDay();
        var  k1 = 0;
        for(var k = weekDayNumber - 1; k >= 0; k--){
            obj[k].innerHTML = lastMonthDayCount - k1;
            k1 ++;
            obj[k].style.color = "#6DA0B4";
         }
        for(var i = 0; i < monthDayCount; i++){
            obj[i + weekDayNumber].innerHTML = i + 1 ;
            obj[i + weekDayNumber].style.color = "#fff";
            //当前日期突出显示
            if(InitalMonthNumber === currentMonth && currentDate === i + 1){
                obj[i + weekDayNumber].style.backgroundColor = "#299FCC";
                obj[i + weekDayNumber].style.border = " 2px solid #85ACBC";
            }else{
                obj[i + weekDayNumber].style.backgroundColor = "";
                obj[i + weekDayNumber].style.border = "";
            }
        }
        for(var j = 0; j < 42 - monthDayCount - weekDayNumber; j++){
            obj[j + monthDayCount + weekDayNumber].innerHTML = j + 1 ;
            obj[j + monthDayCount + weekDayNumber].style.color = "#6DA0B4";
        }
    }
    //初始化日期表
    function initialDateDayNumber(){
        for(var i = 0; i < 42 ; i++){
            var spanl  = document.createElement('span');
            spanl.innerHTML = 0;
            lastMonth.appendChild(spanl);
            var spanc  = document.createElement('span');
            spanc.innerHTML = 0;
            currentMonth.appendChild(spanc);
            var spann  = document.createElement('span');
            spann.innerHTML = 0;
            nextMonth.appendChild(spann);
        }
    }
    //月份越界处理和年份切换
    function monthOutAndYearSwitchJudge(){
        if(InitalMonthNumber < 0){
            InitalFullNumber--;
            InitalMonthNumber = 11;
        }
        if(InitalMonthNumber > 11){
            InitalFullNumber++;
            InitalMonthNumber = 0;
        }
        yearAndMonth.innerHTML =  InitalFullNumber + "年" +  (InitalMonthNumber + 1) + "月";
    }
    //切换月份动画
    function moveAnimation(moveDistance) {
        MTween(lastMonth,moveDistance,duration,'marginTop','linear',function () {
            if(getCss(lastMonth,'marginTop')  === initialPosition*2 || getCss(lastMonth,'marginTop')  === 0){
                lastMonth.style.marginTop = initialPosition + "px";
            }
            isAnimationExecuting = false;
            getDateDayNumber(lastMonthItem,InitalMonthNumber - 1);
            getDateDayNumber(currentMonthItem,InitalMonthNumber);
            getDateDayNumber(nextMonthItem,InitalMonthNumber + 1);
        });
    }
    //设置日期时间设置弹窗的选项
    function initialSelect(){
        var date = new Date();
        var currentYear = parseInt(date.getFullYear());
        var currentMonth = parseInt(date.getMonth());
        var currentDateDay = parseInt(date.getDate());
        var currentMonthNumber= getMonthDayCount(currentMonth);
        var currentHour = parseInt(date.getHours());
        var currentMinute = parseInt(date.getMinutes());
        //日期
        //年丰
        for(var i = -50; i < 50; i++){
            var option = document.createElement('option');
            var text = (currentYear + i).toString() + "年";
            option.value = currentYear + i;
            option.innerHTML = text;
            if(i === 0){
                option.selected = "selected";
            }
            yearSelect.appendChild(option);
        }
        //设置默认的月份选择
        monthSelect.value = monthSelect.querySelectorAll("option")[currentMonth].value;
        //天数
        for(var iDateDay = 0; iDateDay < currentMonthNumber; iDateDay++){
            var dateDayOption = document.createElement('option');
            var dateDayText = (iDateDay + 1).toString() + "日";
            dateDayOption.value = iDateDay;
            dateDayOption.innerHTML = dateDayText;
            if(iDateDay === currentDateDay){
                dateDayOption.selected = "selected";
            }
            dateDaySelect.appendChild(dateDayOption);
        }
        //时间
        for(var iHour = 0; iHour < 24; iHour++){
            var hourOption = document.createElement('option');
            if(iHour < 10)
                hourOption.innerHTML = '0' + iHour.toString();
            else
                hourOption.innerHTML = iHour.toString();
            if(iHour === currentHour){
                hourOption.selected = "selected";
            }
            hourSelect.appendChild(hourOption);
        }
        for(var iMinute = 0; iMinute < 60; iMinute++){
            var minuteOption = document.createElement('option');
            if(iMinute < 10)
                minuteOption.innerHTML = '0' + iMinute.toString();
            else
                minuteOption.innerHTML = iMinute.toString();
            if(iMinute === currentMinute){
                minuteOption.selected = "selected";
            }
            minuteSelect.appendChild(minuteOption);
        }
    }
    //获取每月天数并显示到上面选择菜单上
    $("#yearSelect").change(changeDayNumber);
    $("#monthSelect").change(changeDayNumber);
    function changeDayNumber(){
        var dateDay = $("#dateDaySelect");
        dateDay.empty();// 先清空第二个
        var yearSelectValue = $("#yearSelect").val();
        var monthDayNumber = getMonthDayCount(monthSelect.selectedIndex + 1,yearSelectValue);
        for(var i = 0; i < monthDayNumber; i++){
            var option = $("<option>").val(i).text(i + 1 +"日"); // 根据实际情况（循环）生成多个选项
            dateDay.append(option);
        }
    }
</script>
</body>
</html>